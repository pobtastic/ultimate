<!DOCTYPE html>
<html>
<head>
<title>Atic Atac: Routine at 7E23</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-dark.css" />
</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="logo" src="../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="7DC3.html">7DC3</a>
</td>
<td class="up">Up: <a href="../maps/all.html#7e23">Map</a></td>
<td class="next">
Next: <a href="7E7E.html">7E7E</a>
</td>
</tr>
</table>
<div class="description">7E23: Draw Room</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
<div class="paragraph">
Used by the routine at <a href="7DC3.html">MainLoop</a>.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">DrawRoom</td>
<td class="address-2"><span id="7e23"></span>7E23</td>
<td class="instruction">LD A,($EA91)</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=<a href="EA91.html">PlayerRoom</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e26"></span>7E26</td>
<td class="instruction">LD L,A</td>
<td class="comment-1" rowspan="3">Create an offset in <span class="register">HL</span> (<span class="register">A</span> * 02).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e27"></span>7E27</td>
<td class="instruction">LD H,$00</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e29"></span>7E29</td>
<td class="instruction">ADD HL,HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e2a"></span>7E2A</td>
<td class="instruction">LD BC,$757D</td>
<td class="comment-1" rowspan="2"><span class="register">HL</span>=<a href="757D.html">RoomTable</a> + offset.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e2d"></span>7E2D</td>
<td class="instruction">ADD HL,BC</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e2e"></span>7E2E</td>
<td class="instruction">LD A,(HL)</td>
<td class="comment-1" rowspan="4"><span class="register">HL</span>=the current room data.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e2f"></span>7E2F</td>
<td class="instruction">INC HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e30"></span>7E30</td>
<td class="instruction">LD H,(HL)</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e31"></span>7E31</td>
<td class="instruction">LD L,A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e32"></span>7E32</td>
<td class="instruction">LD ($5E1B),HL</td>
<td class="comment-1" rowspan="1">Stash the room data pointer at <a href="5E1B.html">CurrentRoom</a>.</td>
</tr>
<tr>
<td class="asm-label">Decor_Loop</td>
<td class="address-1"><span id="7e35"></span>7E35</td>
<td class="instruction">LD HL,($5E1B)</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=<a href="5E1B.html">CurrentRoom</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e38"></span>7E38</td>
<td class="instruction">LD A,(HL)</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e39"></span>7E39</td>
<td class="instruction">INC HL</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e3a"></span>7E3A</td>
<td class="instruction">INC HL</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e3b"></span>7E3B</td>
<td class="instruction">LD ($5E1B),HL</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e3e"></span>7E3E</td>
<td class="instruction">DEC HL</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e3f"></span>7E3F</td>
<td class="instruction">LD H,(HL)</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e40"></span>7E40</td>
<td class="instruction">LD L,A</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e41"></span>7E41</td>
<td class="instruction">OR H</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e42"></span>7E42</td>
<td class="instruction">JR NZ,<a href="7E7E.html#7e93">ProcessAction_3</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e44"></span>7E44</td>
<td class="instruction">LD HL,($5E12)</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=<a href="5E12.html">CounterLow</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e47"></span>7E47</td>
<td class="instruction">INC HL</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e48"></span>7E48</td>
<td class="instruction">LD ($5E12),HL</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e4b"></span>7E4B</td>
<td class="instruction">LD HL,$5E14</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=<a href="5E14.html">GameFlags</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e4e"></span>7E4E</td>
<td class="instruction">BIT 0,(HL)</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e50"></span>7E50</td>
<td class="instruction">JR NZ,<a href="7E23.html#7e55">DrawRoom_0</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e52"></span>7E52</td>
<td class="instruction">CALL <a href="9252.html#9291">HandlerCaveDoorLocked_6</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label">DrawRoom_0</td>
<td class="address-2"><span id="7e55"></span>7E55</td>
<td class="instruction">LD HL,$5E14</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=<a href="5E14.html">GameFlags</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e58"></span>7E58</td>
<td class="instruction">SET 0,(HL)</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e5a"></span>7E5A</td>
<td class="instruction">LD HL,($5E05)</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e5d"></span>7E5D</td>
<td class="instruction">LD DE,($5C78)</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e61"></span>7E61</td>
<td class="instruction">ADD HL,DE</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e62"></span>7E62</td>
<td class="instruction">LD A,($5E12)</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=<a href="5E12.html">CounterLow</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e65"></span>7E65</td>
<td class="instruction">ADD A,L</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e66"></span>7E66</td>
<td class="instruction">LD L,A</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e67"></span>7E67</td>
<td class="instruction">LD ($5E05),HL</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e6a"></span>7E6A</td>
<td class="instruction">CALL <a href="9252.html#938b">HandlerCaveDoorLocked_18</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e6d"></span>7E6D</td>
<td class="instruction">CALL <a href="9489.html">$9489</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e70"></span>7E70</td>
<td class="instruction">CALL <a href="98D2.html#9924">SetKeyPositions_1</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e73"></span>7E73</td>
<td class="instruction">LD A,($EA91)</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=<a href="EA91.html">PlayerRoom</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e76"></span>7E76</td>
<td class="instruction">CP $8E</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e78"></span>7E78</td>
<td class="instruction">JP Z,<a href="96EC.html">GameComplete</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e7b"></span>7E7B</td>
<td class="instruction">JP <a href="7DC3.html">MainLoop</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="7DC3.html">MainLoop</a>.</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="7DC3.html">7DC3</a>
</td>
<td class="up">Up: <a href="../maps/all.html#7e23">Map</a></td>
<td class="next">
Next: <a href="7E7E.html">7E7E</a>
</td>
</tr>
</table>
<footer>
<div class="release"></div>
<div class="copyright">&copy; 1983 Ultimate Play the Game</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 8.6.</div>
<div><a href="../../dec/asm/32291.html">Switch to decimal</a>.</div>
</footer>
</body>
</html>