<!DOCTYPE html>
<html>
<head>
<title>Atic Atac: Routine at 7C19</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-dark.css" />
</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="logo" src="../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="7C17.html">7C17</a>
</td>
<td class="up">Up: <a href="../maps/all.html#7c19">Map</a></td>
<td class="next">
Next: <a href="7C90.html">7C90</a>
</td>
</tr>
</table>
<div class="description">7C19: Game Entry Point</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
<div class="paragraph">
Used by the routine at <a href="6000.html">SecurityCheck</a>.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">GameInitialisation</td>
<td class="address-2"><span id="7c19"></span>7C19</td>
<td class="instruction">LD HL,$5E00</td>
<td class="comment-1" rowspan="5">Write 00 to 10 bytes, from <a href="5E00.html">GameOptions</a> to 5E10.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7c1c"></span>7C1C</td>
<td class="instruction">LD B,$10</td>
</tr>
<tr>
<td class="asm-label">GameInitialisation_Loop</td>
<td class="address-2"><span id="7c1e"></span>7C1E</td>
<td class="instruction">LD (HL),$00</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7c20"></span>7C20</td>
<td class="instruction">INC HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7c21"></span>7C21</td>
<td class="instruction">DJNZ <a href="7C19.html#7c1e">GameInitialisation_Loop</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7c23"></span>7C23</td>
<td class="instruction">LD HL,$BE4C</td>
<td class="comment-1" rowspan="2">Write <a href="BE4C.html">MainFont</a> to <a href="5E01.html">FontPointer</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7c26"></span>7C26</td>
<td class="instruction">LD ($5E01),HL</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="7c29"></span>
<div class="comments">
<div class="paragraph">
This entry point is used by the routine at <a href="8C35.html">GameOver</a>.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">Game_Restart</td>
<td class="address-2"><span id="7c29"></span>7C29</td>
<td class="instruction">CALL <a href="80AA.html">ClearScreen</a></td>
<td class="comment-1" rowspan="1">Call <a href="80AA.html">ClearScreen</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7c2c"></span>7C2C</td>
<td class="instruction">CALL <a href="A311.html">MenuIcons</a></td>
<td class="comment-1" rowspan="1">Call <a href="A311.html">MenuIcons</a>.</td>
</tr>
<tr>
<td class="asm-label">GameSelect_Loop</td>
<td class="address-2"><span id="7c2f"></span>7C2F</td>
<td class="instruction">CALL <a href="7CAF.html">GameMenu</a></td>
<td class="comment-1" rowspan="1">Call <a href="7CAF.html">GameMenu</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7c32"></span>7C32</td>
<td class="instruction">LD A,$F7</td>
<td class="comment-1" rowspan="3">Read from the keyboard; <table class="default">
<tr>
<th colspan="1" rowspan="2">Port Number</th>
<th colspan="5" rowspan="1">Bit</th>
</tr>
<tr>
<th colspan="1" rowspan="1">0</th>
<th colspan="1" rowspan="1">1</th>
<th colspan="1" rowspan="1">2</th>
<th colspan="1" rowspan="1">3</th>
<th colspan="1" rowspan="1">4</th>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1">F7</td>
<td class="centre" colspan="1" rowspan="1">1</td>
<td class="centre" colspan="1" rowspan="1">2</td>
<td class="centre" colspan="1" rowspan="1">3</td>
<td class="centre" colspan="1" rowspan="1">4</td>
<td class="centre" colspan="1" rowspan="1">5</td>
</tr>
</table></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7c34"></span>7C34</td>
<td class="instruction">OUT ($FD),A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7c36"></span>7C36</td>
<td class="instruction">IN A,($FE)</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7c38"></span>7C38</td>
<td class="instruction">CPL</td>
<td class="comment-1" rowspan="1">Flip the bits.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7c39"></span>7C39</td>
<td class="instruction">LD E,A</td>
<td class="comment-1" rowspan="1"><span class="register">E</span>=<span class="register">A</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7c3a"></span>7C3A</td>
<td class="instruction">LD A,($5E00)</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=<a href="5E00.html">GameOptions</a>.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="7c3d"></span>
<div class="comments">
<div class="paragraph">
Handle Keyboard selection.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7c3d"></span>7C3D</td>
<td class="instruction">BIT 0,E</td>
<td class="comment-1" rowspan="1">Has key "1" been pressed? ("KEYBOARD").</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7c3f"></span>7C3F</td>
<td class="instruction">JR Z,<a href="7C19.html#7c43">GameSelect_CheckKempston</a></td>
<td class="comment-1" rowspan="1">If not jump to <a href="7C19.html#7c43">GameSelect_CheckKempston</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7c41"></span>7C41</td>
<td class="instruction">AND %11111001</td>
<td class="comment-1" rowspan="1">Keep only bits 0, 3-7.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="7c43"></span>
<div class="comments">
<div class="paragraph">
Handle Kempston Joystick selection.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">GameSelect_CheckKempston</td>
<td class="address-2"><span id="7c43"></span>7C43</td>
<td class="instruction">BIT 1,E</td>
<td class="comment-1" rowspan="1">Has key "2" been pressed? ("KEMPSTON JOYSTICK").</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7c45"></span>7C45</td>
<td class="instruction">JR Z,<a href="7C19.html#7c4b">GameSelect_CheckCursor</a></td>
<td class="comment-1" rowspan="1">If not jump to <a href="7C19.html#7c4b">GameSelect_CheckCursor</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7c47"></span>7C47</td>
<td class="instruction">AND %11111001</td>
<td class="comment-1" rowspan="1">Keep only bits 0, 3-7.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7c49"></span>7C49</td>
<td class="instruction">OR %00000010</td>
<td class="comment-1" rowspan="1">Set control method = 02.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="7c4b"></span>
<div class="comments">
<div class="paragraph">
Handle Cursor Joystick selection.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">GameSelect_CheckCursor</td>
<td class="address-2"><span id="7c4b"></span>7C4B</td>
<td class="instruction">BIT 2,E</td>
<td class="comment-1" rowspan="1">Has key "3" been pressed? ("CURSOR JOYSTICK").</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7c4d"></span>7C4D</td>
<td class="instruction">JR Z,<a href="7C19.html#7c53">GameSelect_CheckKnight</a></td>
<td class="comment-1" rowspan="1">If not jump to <a href="7C19.html#7c53">GameSelect_CheckKnight</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7c4f"></span>7C4F</td>
<td class="instruction">AND %11111001</td>
<td class="comment-1" rowspan="1">Keep only bits 0, 3-7.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7c51"></span>7C51</td>
<td class="instruction">OR %00000100</td>
<td class="comment-1" rowspan="1">Set control method = 04.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="7c53"></span>
<div class="comments">
<div class="paragraph">
Handle "Knight" selection.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">GameSelect_CheckKnight</td>
<td class="address-2"><span id="7c53"></span>7C53</td>
<td class="instruction">BIT 3,E</td>
<td class="comment-1" rowspan="1">Has key "4" been pressed? ("KNIGHT").</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7c55"></span>7C55</td>
<td class="instruction">JR Z,<a href="7C19.html#7c59">GameSelect_CheckWizard</a></td>
<td class="comment-1" rowspan="1">If not jump to <a href="7C19.html#7c59">GameSelect_CheckWizard</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7c57"></span>7C57</td>
<td class="instruction">AND %11100111</td>
<td class="comment-1" rowspan="1">Keep only bits 0-2, 5-7.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="7c59"></span>
<div class="comments">
<div class="paragraph">
Handle "Wizard" selection.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">GameSelect_CheckWizard</td>
<td class="address-2"><span id="7c59"></span>7C59</td>
<td class="instruction">BIT 4,E</td>
<td class="comment-1" rowspan="1">Has key "5" been pressed? ("WIZARD").</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7c5b"></span>7C5B</td>
<td class="instruction">JR Z,<a href="7C19.html#7c61">GameInitialisation_0</a></td>
<td class="comment-1" rowspan="1">If not jump to <a href="7C19.html#7c61">GameInitialisation_0</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7c5d"></span>7C5D</td>
<td class="instruction">AND %11100111</td>
<td class="comment-1" rowspan="1">Keep only bits 0-2, 5-7.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7c5f"></span>7C5F</td>
<td class="instruction">OR %00001000</td>
<td class="comment-1" rowspan="1">Set player = 08.</td>
</tr>
<tr>
<td class="asm-label">GameInitialisation_0</td>
<td class="address-2"><span id="7c61"></span>7C61</td>
<td class="instruction">LD D,A</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7c62"></span>7C62</td>
<td class="instruction">LD A,$EF</td>
<td class="comment-1" rowspan="3">Read from the keyboard; <table class="default">
<tr>
<th colspan="1" rowspan="2">Port Number</th>
<th colspan="5" rowspan="1">Bit</th>
</tr>
<tr>
<th colspan="1" rowspan="1">0</th>
<th colspan="1" rowspan="1">1</th>
<th colspan="1" rowspan="1">2</th>
<th colspan="1" rowspan="1">3</th>
<th colspan="1" rowspan="1">4</th>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1">EF</td>
<td class="centre" colspan="1" rowspan="1">0</td>
<td class="centre" colspan="1" rowspan="1">9</td>
<td class="centre" colspan="1" rowspan="1">8</td>
<td class="centre" colspan="1" rowspan="1">7</td>
<td class="centre" colspan="1" rowspan="1">6</td>
</tr>
</table></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7c64"></span>7C64</td>
<td class="instruction">OUT ($FD),A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7c66"></span>7C66</td>
<td class="instruction">IN A,($FE)</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7c68"></span>7C68</td>
<td class="instruction">CPL</td>
<td class="comment-1" rowspan="1">Flip the bits.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7c69"></span>7C69</td>
<td class="instruction">LD E,A</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7c6a"></span>7C6A</td>
<td class="instruction">LD A,D</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="7c6b"></span>
<div class="comments">
<div class="paragraph">
Handle choosing "Serf".
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">GameSelect_CheckSerf</td>
<td class="address-1"><span id="7c6b"></span>7C6B</td>
<td class="instruction">BIT 4,E</td>
<td class="comment-1" rowspan="1">Has key "6" been pressed? ("SERF").</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7c6d"></span>7C6D</td>
<td class="instruction">JR Z,<a href="7C19.html#7c73">GameInitialisation_1</a></td>
<td class="comment-1" rowspan="1">If not skip to <a href="7C19.html#7c73">GameInitialisation_1</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7c6f"></span>7C6F</td>
<td class="instruction">AND %11100111</td>
<td class="comment-1" rowspan="1">Keep only bits 0-2, 5-7.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7c71"></span>7C71</td>
<td class="instruction">OR %00010000</td>
<td class="comment-1" rowspan="1">Set bit 4.</td>
</tr>
<tr>
<td class="asm-label">GameInitialisation_1</td>
<td class="address-2"><span id="7c73"></span>7C73</td>
<td class="instruction">LD ($5E00),A</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7c76"></span>7C76</td>
<td class="instruction">LD C,A</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="7c77"></span>
<div class="comments">
<div class="paragraph">
Handle starting a new game.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">GameSelect_Start</td>
<td class="address-1"><span id="7c77"></span>7C77</td>
<td class="instruction">BIT 0,E</td>
<td class="comment-1" rowspan="1">Has key "0" been pressed? ("START GAME").</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7c79"></span>7C79</td>
<td class="instruction">JP NZ,<a href="7D9A.html">StartGame</a></td>
<td class="comment-1" rowspan="1">If so, jump to <a href="7D9A.html">StartGame</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7c7c"></span>7C7C</td>
<td class="instruction">LD HL,$7CEA</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=<a href="7CEA.html">GameSelection_Attributes</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7c7f"></span>7C7F</td>
<td class="instruction">LD B,$03</td>
<td class="comment-1" rowspan="1"><span class="register">B</span>=03 (counter).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7c81"></span>7C81</td>
<td class="instruction">LD A,C</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=<span class="register">C</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7c82"></span>7C82</td>
<td class="instruction">CALL <a href="7C90.html">$7C90</a></td>
<td class="comment-1" rowspan="1">Call <a href="7C90.html">7C90</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7c85"></span>7C85</td>
<td class="instruction">LD B,$03</td>
<td class="comment-1" rowspan="1"><span class="register">B</span>=03 (counter).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7c87"></span>7C87</td>
<td class="instruction">LD A,C</td>
<td class="comment-1" rowspan="3"><span class="register">A</span>=<span class="register">C</span> / 04.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7c88"></span>7C88</td>
<td class="instruction">RRCA</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7c89"></span>7C89</td>
<td class="instruction">RRCA</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7c8a"></span>7C8A</td>
<td class="instruction">CALL <a href="7C90.html">$7C90</a></td>
<td class="comment-1" rowspan="1">Call <a href="7C90.html">7C90</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7c8d"></span>7C8D</td>
<td class="instruction">JP <a href="7C19.html#7c2f">GameSelect_Loop</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="7C19.html#7c2f">GameSelect_Loop</a>.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<div class="comments">
<div class="paragraph">
View the equivalent code in; <ul class="">
<li><a href="../../../cookie/hex/asm/6298.html">Cookie</a></li>
<li><a href="../../../lunarjetman/hex/asm/800A.html">Lunar Jetman</a></li>
<li><a href="../../../pssst/hex/asm/61CD.html">Pssst</a></li>
<li><a href="../../../tranzam/hex/asm/5F07.html">Tranz Am</a></li>
</ul>
</div>
</div>
</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="7C17.html">7C17</a>
</td>
<td class="up">Up: <a href="../maps/all.html#7c19">Map</a></td>
<td class="next">
Next: <a href="7C90.html">7C90</a>
</td>
</tr>
</table>
<footer>
<div class="release"></div>
<div class="copyright">&copy; 1983 Ultimate Play the Game</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 8.6.</div>
<div><a href="../../dec/asm/31769.html">Switch to decimal</a>.</div>
</footer>
</body>
</html>