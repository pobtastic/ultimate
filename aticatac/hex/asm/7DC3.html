<!DOCTYPE html>
<html>
<head>
<title>Atic Atac: Routine at 7DC3</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-dark.css" />
</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="logo" src="../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="7D9A.html">7D9A</a>
</td>
<td class="up">Up: <a href="../maps/all.html#7dc3">Map</a></td>
<td class="next">
Next: <a href="7E23.html">7E23</a>
</td>
</tr>
</table>
<div class="description">7DC3: Main Loop</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
<div class="paragraph">
Used by the routines at <a href="7E23.html">DrawRoom</a> and <a href="9147.html">EnterRoom</a>.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">MainLoop</td>
<td class="address-2"><span id="7dc3"></span>7DC3</td>
<td class="instruction">LD SP,$5E00</td>
<td class="comment-1" rowspan="1">Set stack pointer to 5E00.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7dc6"></span>7DC6</td>
<td class="instruction">EI</td>
<td class="comment-1" rowspan="1">Enable interrupts.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7dc7"></span>7DC7</td>
<td class="instruction">XOR A</td>
<td class="comment-1" rowspan="2">Write 00 to <a href="5E25.html">NumCreatures</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7dc8"></span>7DC8</td>
<td class="instruction">LD ($5E25),A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7dcb"></span>7DCB</td>
<td class="instruction">LD IX,$EAA8</td>
<td class="comment-1" rowspan="1"><span class="register">IX</span>=<a href="EAA8.html">EAA8</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7dcf"></span>7DCF</td>
<td class="instruction">LD A,($5E14)</td>
<td class="comment-1" rowspan="3">Checking bit 0 of <a href="5E14.html">GameFlags</a>; jump to <a href="7DC3.html#7ddc">MainLoop_0</a> if the room content is already drawn.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7dd2"></span>7DD2</td>
<td class="instruction">BIT 0,A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7dd4"></span>7DD4</td>
<td class="instruction">JR NZ,<a href="7DC3.html#7ddc">MainLoop_0</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7dd6"></span>7DD6</td>
<td class="instruction">LD IX,$EEE0</td>
<td class="comment-1" rowspan="1"><span class="register">IX</span>=<a href="EEE0.html">EEE0</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7dda"></span>7DDA</td>
<td class="instruction">JR <a href="7E23.html">DrawRoom</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="7E23.html">DrawRoom</a>.</td>
</tr>
<tr>
<td class="asm-label">MainLoop_0</td>
<td class="address-2"><span id="7ddc"></span>7DDC</td>
<td class="instruction">LD A,($5C78)</td>
<td class="comment-1" rowspan="2"><span class="register">A</span>=<a href="https://skoolkid.github.io/rom/asm/5C78.html">FRAMES</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7ddf"></span>7DDF</td>
<td class="instruction">LD C,A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7de0"></span>7DE0</td>
<td class="instruction">LD A,($5E03)</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=<a href="5E03.html">5E03</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7de3"></span>7DE3</td>
<td class="instruction">CP C</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7de4"></span>7DE4</td>
<td class="instruction">CALL NZ,<a href="7E7E.html#7eb2">ProcessAction_5</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7de7"></span>7DE7</td>
<td class="instruction">LD A,($EA91)</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=<a href="EA91.html">PlayerRoom</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7dea"></span>7DEA</td>
<td class="instruction">CP (IX+$01)</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7ded"></span>7DED</td>
<td class="instruction">LD HL,$7DF3</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=<a href="7DC3.html#7df3">7DF3</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7df0"></span>7DF0</td>
<td class="instruction">JP Z,<a href="7E7E.html">ProcessAction</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7df3"></span>7DF3</td>
<td class="instruction">LD DE,$0008</td>
<td class="comment-1" rowspan="1"><span class="register">DE</span>=0008.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7df6"></span>7DF6</td>
<td class="instruction">ADD IX,DE</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7df8"></span>7DF8</td>
<td class="instruction">PUSH IX</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7dfa"></span>7DFA</td>
<td class="instruction">POP HL</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7dfb"></span>7DFB</td>
<td class="instruction">LD DE,$EE60</td>
<td class="comment-1" rowspan="1"><span class="register">DE</span>=<a href="EE60.html">EE60</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7dfe"></span>7DFE</td>
<td class="instruction">AND A</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7dff"></span>7DFF</td>
<td class="instruction">SBC HL,DE</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e01"></span>7E01</td>
<td class="instruction">JR C,<a href="7DC3.html#7ddc">MainLoop_0</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label">MainLoop_1</td>
<td class="address-2"><span id="7e03"></span>7E03</td>
<td class="instruction">LD A,($5C78)</td>
<td class="comment-1" rowspan="2"><span class="register">A</span>=<a href="https://skoolkid.github.io/rom/asm/5C78.html">FRAMES</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e06"></span>7E06</td>
<td class="instruction">LD C,A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e07"></span>7E07</td>
<td class="instruction">LD A,($5E03)</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=<a href="5E03.html">5E03</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e0a"></span>7E0A</td>
<td class="instruction">CP C</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e0b"></span>7E0B</td>
<td class="instruction">CALL NZ,<a href="7E7E.html#7eb2">ProcessAction_5</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e0e"></span>7E0E</td>
<td class="instruction">LD HL,$7E13</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=<a href="7DC3.html#7e13">7E13</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e11"></span>7E11</td>
<td class="instruction">JR <a href="7E7E.html">ProcessAction</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e13"></span>7E13</td>
<td class="instruction">LD DE,$0010</td>
<td class="comment-1" rowspan="1"><span class="register">DE</span>=0010.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e16"></span>7E16</td>
<td class="instruction">ADD IX,DE</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e18"></span>7E18</td>
<td class="instruction">PUSH IX</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e1a"></span>7E1A</td>
<td class="instruction">POP HL</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e1b"></span>7E1B</td>
<td class="instruction">LD DE,$EEE0</td>
<td class="comment-1" rowspan="1"><span class="register">DE</span>=<a href="EEE0.html">EEE0</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e1e"></span>7E1E</td>
<td class="instruction">AND A</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e1f"></span>7E1F</td>
<td class="instruction">SBC HL,DE</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7e21"></span>7E21</td>
<td class="instruction">JR C,<a href="7DC3.html#7e03">MainLoop_1</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="7D9A.html">7D9A</a>
</td>
<td class="up">Up: <a href="../maps/all.html#7dc3">Map</a></td>
<td class="next">
Next: <a href="7E23.html">7E23</a>
</td>
</tr>
</table>
<footer>
<div class="release"></div>
<div class="copyright">&copy; 1983 Ultimate Play the Game</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 8.6.</div>
<div><a href="../../dec/asm/32195.html">Switch to decimal</a>.</div>
</footer>
</body>
</html>