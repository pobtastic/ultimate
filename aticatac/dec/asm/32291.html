<!DOCTYPE html>
<html>
<head>
<title>Atic Atac: Routine at 32291</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-dark.css" />
</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="logo" src="../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="32195.html">32195</a>
</td>
<td class="up">Up: <a href="../maps/all.html#32291">Map</a></td>
<td class="next">
Next: <a href="32382.html">32382</a>
</td>
</tr>
</table>
<div class="description">32291: Draw Room</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
<div class="paragraph">
Used by the routine at <a href="32195.html">MainLoop</a>.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">DrawRoom</td>
<td class="address-2"><span id="32291"></span>32291</td>
<td class="instruction">LD A,(60049)</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=<a href="60049.html">PlayerRoom</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="32294"></span>32294</td>
<td class="instruction">LD L,A</td>
<td class="comment-1" rowspan="3">Create an offset in <span class="register">HL</span> (<span class="register">A</span> * 2).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="32295"></span>32295</td>
<td class="instruction">LD H,0</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="32297"></span>32297</td>
<td class="instruction">ADD HL,HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="32298"></span>32298</td>
<td class="instruction">LD BC,30077</td>
<td class="comment-1" rowspan="2"><span class="register">HL</span>=<a href="30077.html">RoomTable</a> + offset.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="32301"></span>32301</td>
<td class="instruction">ADD HL,BC</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="32302"></span>32302</td>
<td class="instruction">LD A,(HL)</td>
<td class="comment-1" rowspan="4"><span class="register">HL</span>=the current room data.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="32303"></span>32303</td>
<td class="instruction">INC HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="32304"></span>32304</td>
<td class="instruction">LD H,(HL)</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="32305"></span>32305</td>
<td class="instruction">LD L,A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="32306"></span>32306</td>
<td class="instruction">LD (24091),HL</td>
<td class="comment-1" rowspan="1">Stash the room data pointer at <a href="24091.html">CurrentRoom</a>.</td>
</tr>
<tr>
<td class="asm-label">Decor_Loop</td>
<td class="address-1"><span id="32309"></span>32309</td>
<td class="instruction">LD HL,(24091)</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=<a href="24091.html">CurrentRoom</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="32312"></span>32312</td>
<td class="instruction">LD A,(HL)</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="32313"></span>32313</td>
<td class="instruction">INC HL</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="32314"></span>32314</td>
<td class="instruction">INC HL</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="32315"></span>32315</td>
<td class="instruction">LD (24091),HL</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="32318"></span>32318</td>
<td class="instruction">DEC HL</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="32319"></span>32319</td>
<td class="instruction">LD H,(HL)</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="32320"></span>32320</td>
<td class="instruction">LD L,A</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="32321"></span>32321</td>
<td class="instruction">OR H</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="32322"></span>32322</td>
<td class="instruction">JR NZ,<a href="32382.html#32403">ProcessAction_3</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="32324"></span>32324</td>
<td class="instruction">LD HL,(24082)</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=<a href="24082.html">CounterLow</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="32327"></span>32327</td>
<td class="instruction">INC HL</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="32328"></span>32328</td>
<td class="instruction">LD (24082),HL</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="32331"></span>32331</td>
<td class="instruction">LD HL,24084</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=<a href="24084.html">GameFlags</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="32334"></span>32334</td>
<td class="instruction">BIT 0,(HL)</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="32336"></span>32336</td>
<td class="instruction">JR NZ,<a href="32291.html#32341">DrawRoom_0</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="32338"></span>32338</td>
<td class="instruction">CALL <a href="37458.html#37521">HandlerCaveDoorLocked_6</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label">DrawRoom_0</td>
<td class="address-2"><span id="32341"></span>32341</td>
<td class="instruction">LD HL,24084</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=<a href="24084.html">GameFlags</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="32344"></span>32344</td>
<td class="instruction">SET 0,(HL)</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="32346"></span>32346</td>
<td class="instruction">LD HL,(24069)</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="32349"></span>32349</td>
<td class="instruction">LD DE,(23672)</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="32353"></span>32353</td>
<td class="instruction">ADD HL,DE</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="32354"></span>32354</td>
<td class="instruction">LD A,(24082)</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=<a href="24082.html">CounterLow</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="32357"></span>32357</td>
<td class="instruction">ADD A,L</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="32358"></span>32358</td>
<td class="instruction">LD L,A</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="32359"></span>32359</td>
<td class="instruction">LD (24069),HL</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="32362"></span>32362</td>
<td class="instruction">CALL <a href="37458.html#37771">HandlerCaveDoorLocked_18</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="32365"></span>32365</td>
<td class="instruction">CALL <a href="38025.html">38025</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="32368"></span>32368</td>
<td class="instruction">CALL <a href="39122.html#39204">SetKeyPositions_1</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="32371"></span>32371</td>
<td class="instruction">LD A,(60049)</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=<a href="60049.html">PlayerRoom</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="32374"></span>32374</td>
<td class="instruction">CP 142</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="32376"></span>32376</td>
<td class="instruction">JP Z,<a href="38636.html">GameComplete</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="32379"></span>32379</td>
<td class="instruction">JP <a href="32195.html">MainLoop</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="32195.html">MainLoop</a>.</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="32195.html">32195</a>
</td>
<td class="up">Up: <a href="../maps/all.html#32291">Map</a></td>
<td class="next">
Next: <a href="32382.html">32382</a>
</td>
</tr>
</table>
<footer>
<div class="release"></div>
<div class="copyright">&copy; 1983 Ultimate Play the Game</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 8.6.</div>
<div><a href="../../hex/asm/7E23.html">Switch to hexadecimal</a>.</div>
</footer>
</body>
</html>