<!DOCTYPE html>
<html>
<head>
<title>Sabre Wulf: Routine at ADD0</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-dark.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-wide.css" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-75RERFCHBG"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-75RERFCHBG');
</script>
</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="logo" src="../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="ADBF.html">ADBF</a>
</td>
<td class="up">Up: <a href="../maps/all.html#add0">Map</a></td>
<td class="next">
Next: <a href="AE34.html">AE34</a>
</td>
</tr>
</table>
<div class="description">ADD0: Player Movement</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
</div>
</td>
</tr>
<tr>
<td class="asm-label">PlayerMovement</td>
<td class="address-2"><span id="add0"></span>ADD0</td>
<td class="instruction">CALL <a href="BB0B.html">StoreEntity</a></td>
<td class="comment-1" rowspan="1">Call <a href="BB0B.html">StoreEntity</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="add3"></span>ADD3</td>
<td class="instruction">CALL <a href="A18C.html">$A18C</a></td>
<td class="comment-1" rowspan="1">Call <a href="A18C.html">A18C</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="add6"></span>ADD6</td>
<td class="instruction">LD A,$10</td>
<td class="comment-1" rowspan="2">Write 10 to <a href="96A9.html#96ad">96AD</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="add8"></span>ADD8</td>
<td class="instruction">LD ($96AD),A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="addb"></span>ADDB</td>
<td class="instruction">LD A,(IX+$02)</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="adde"></span>ADDE</td>
<td class="instruction">AND A</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="addf"></span>ADDF</td>
<td class="instruction">JP NZ,<a href="A985.html">$A985</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="ade2"></span>
<div class="comments">
<div class="paragraph">
Initialise the player movement (0000 == no movement).
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ade2"></span>ADE2</td>
<td class="instruction">LD DE,$0000</td>
<td class="comment-1" rowspan="1"><span class="register">DE</span>=0000.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ade5"></span>ADE5</td>
<td class="instruction">CALL <a href="B0A3.html">HandlerControls</a></td>
<td class="comment-1" rowspan="1">Call <a href="B0A3.html">HandlerControls</a>.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="ade8"></span>
<div class="comments">
<div class="paragraph">
Check if the player is under the influence of an orchid.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ade8"></span>ADE8</td>
<td class="instruction">LD A,(IX+$05)</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=the colour of the player.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="adeb"></span>ADEB</td>
<td class="instruction">CP $47</td>
<td class="comment-1" rowspan="2">If the player is not using attribute 47 (white) then jump to <a href="AE34.html">AE34</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="aded"></span>ADED</td>
<td class="instruction">JR NZ,<a href="AE34.html">$AE34</a></td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="adef"></span>
<div class="comments">
<div class="paragraph">
Controllers for player controls.
</div>
<div class="paragraph">
Handle "fire".
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="adef"></span>ADEF</td>
<td class="instruction">BIT 4,C</td>
<td class="comment-1" rowspan="2">Jump to <a href="AE34.html">AE34</a> if "fire" was pressed.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="adf1"></span>ADF1</td>
<td class="instruction">JR Z,<a href="AE34.html">$AE34</a></td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="adf3"></span>
<div class="comments">
<div class="paragraph">
Handle "right".
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="adf3"></span>ADF3</td>
<td class="instruction">BIT 1,C</td>
<td class="comment-1" rowspan="2">Jump to <a href="ADD0.html#adfb">PlayerMovement_Left</a> if "right" was pressed.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="adf5"></span>ADF5</td>
<td class="instruction">JR Z,<a href="ADD0.html#adfb">PlayerMovement_Left</a></td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="adf7"></span>
<div class="comments">
<div class="paragraph">
Update movement for moving right.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="adf7"></span>ADF7</td>
<td class="instruction">LD A,E</td>
<td class="comment-1" rowspan="3"><span class="register">E</span>=<span class="register">E</span>+20.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="adf8"></span>ADF8</td>
<td class="instruction">ADD A,$20</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="adfa"></span>ADFA</td>
<td class="instruction">LD E,A</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="adfb"></span>
<div class="comments">
<div class="paragraph">
Handle "left".
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">PlayerMovement_Left</td>
<td class="address-2"><span id="adfb"></span>ADFB</td>
<td class="instruction">BIT 0,C</td>
<td class="comment-1" rowspan="2">Jump to <a href="ADD0.html#ae03">PlayerMovement_Down</a> if "left" was pressed.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="adfd"></span>ADFD</td>
<td class="instruction">JR Z,<a href="ADD0.html#ae03">PlayerMovement_Down</a></td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="adff"></span>
<div class="comments">
<div class="paragraph">
Update movement for moving left.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="adff"></span>ADFF</td>
<td class="instruction">LD A,E</td>
<td class="comment-1" rowspan="3"><span class="register">E</span>=<span class="register">E</span>-20.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ae00"></span>AE00</td>
<td class="instruction">SUB $20</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ae02"></span>AE02</td>
<td class="instruction">LD E,A</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="ae03"></span>
<div class="comments">
<div class="paragraph">
Handle "down".
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">PlayerMovement_Down</td>
<td class="address-2"><span id="ae03"></span>AE03</td>
<td class="instruction">BIT 2,C</td>
<td class="comment-1" rowspan="2">Jump to <a href="ADD0.html#ae0b">PlayerMovement_Up</a> if "down" was pressed.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ae05"></span>AE05</td>
<td class="instruction">JR Z,<a href="ADD0.html#ae0b">PlayerMovement_Up</a></td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="ae07"></span>
<div class="comments">
<div class="paragraph">
Update movement for moving down.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ae07"></span>AE07</td>
<td class="instruction">LD A,D</td>
<td class="comment-1" rowspan="3"><span class="register">D</span>=<span class="register">D</span>-20.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ae08"></span>AE08</td>
<td class="instruction">SUB $20</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ae0a"></span>AE0A</td>
<td class="instruction">LD D,A</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="ae0b"></span>
<div class="comments">
<div class="paragraph">
Handle "up".
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">PlayerMovement_Up</td>
<td class="address-2"><span id="ae0b"></span>AE0B</td>
<td class="instruction">BIT 3,C</td>
<td class="comment-1" rowspan="2">Jump to <a href="ADD0.html#ae13">PlayerMovement_0</a> if "up" was pressed.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ae0d"></span>AE0D</td>
<td class="instruction">JR Z,<a href="ADD0.html#ae13">PlayerMovement_0</a></td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="ae0f"></span>
<div class="comments">
<div class="paragraph">
Update movement for moving up.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ae0f"></span>AE0F</td>
<td class="instruction">LD A,D</td>
<td class="comment-1" rowspan="3"><span class="register">D</span>=<span class="register">D</span>+20.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ae10"></span>AE10</td>
<td class="instruction">ADD A,$20</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ae12"></span>AE12</td>
<td class="instruction">LD D,A</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="ae13"></span>
<div class="comments">
<div class="paragraph">
Update the player Actor Entity.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">PlayerMovement_0</td>
<td class="address-2"><span id="ae13"></span>AE13</td>
<td class="instruction">LD (IX+$06),E</td>
<td class="comment-1" rowspan="1">Write <span class="register">E</span> to <span class="register">IX</span>+06.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ae16"></span>AE16</td>
<td class="instruction">LD (IX+$07),D</td>
<td class="comment-1" rowspan="1">Write <span class="register">D</span> to <span class="register">IX</span>+07.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ae19"></span>AE19</td>
<td class="instruction">CALL <a href="AFE8.html">$AFE8</a></td>
<td class="comment-1" rowspan="1">Call <a href="AFE8.html">AFE8</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ae1c"></span>AE1C</td>
<td class="instruction">LD BC,$160E</td>
<td class="comment-1" rowspan="1"><span class="register">BC</span>=160E.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ae1f"></span>AE1F</td>
<td class="instruction">CALL <a href="B81C.html">$B81C</a></td>
<td class="comment-1" rowspan="1">Call <a href="B81C.html">B81C</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ae22"></span>AE22</td>
<td class="instruction">CALL <a href="AE4B.html">$AE4B</a></td>
<td class="comment-1" rowspan="1">Call <a href="AE4B.html">AE4B</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ae25"></span>AE25</td>
<td class="instruction">CALL <a href="AAED.html">$AAED</a></td>
<td class="comment-1" rowspan="1">Call <a href="AAED.html">AAED</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ae28"></span>AE28</td>
<td class="instruction">LD (IX+$03),E</td>
<td class="comment-1" rowspan="1">Write <span class="register">E</span> to <span class="register">IX</span>+03 (sprite x co-ordinate).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ae2b"></span>AE2B</td>
<td class="instruction">LD (IX+$04),D</td>
<td class="comment-1" rowspan="1">Write <span class="register">D</span> to <span class="register">IX</span>+04 (sprite y co-ordinate).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ae2e"></span>AE2E</td>
<td class="instruction">CALL NZ,<a href="BF4B.html">$BF4B</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ae31"></span>AE31</td>
<td class="instruction">JP <a href="AD57.html#ad5d">$AD5D</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="AD57.html#ad5d">AD5D</a>.</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="ADBF.html">ADBF</a>
</td>
<td class="up">Up: <a href="../maps/all.html#add0">Map</a></td>
<td class="next">
Next: <a href="AE34.html">AE34</a>
</td>
</tr>
</table>
<footer>
<div class="release"></div>
<div class="copyright">&copy; 1983 Ultimate Play the Game &copy; 2023 ArcadeGeek LTD.</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 8.10.</div>
<div><a href="../dec/asm/44496.html">Switch to decimal</a>.</div>
</footer>
</body>
</html>