<!DOCTYPE html>
<html>
<head>
<title>Sabre Wulf: Routine at 44496</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-dark.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-wide.css" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-75RERFCHBG"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-75RERFCHBG');
</script>
</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="logo" src="../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="44479.html">44479</a>
</td>
<td class="up">Up: <a href="../maps/all.html#44496">Map</a></td>
<td class="next">
Next: <a href="44596.html">44596</a>
</td>
</tr>
</table>
<div class="description">44496: Player Movement</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
</div>
</td>
</tr>
<tr>
<td class="asm-label">PlayerMovement</td>
<td class="address-2"><span id="44496"></span>44496</td>
<td class="instruction">CALL <a href="47883.html">StoreEntity</a></td>
<td class="comment-1" rowspan="1">Call <a href="47883.html">StoreEntity</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44499"></span>44499</td>
<td class="instruction">CALL <a href="41356.html">41356</a></td>
<td class="comment-1" rowspan="1">Call <a href="41356.html">41356</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44502"></span>44502</td>
<td class="instruction">LD A,16</td>
<td class="comment-1" rowspan="2">Write 16 to <a href="38569.html#38573">38573</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44504"></span>44504</td>
<td class="instruction">LD (38573),A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44507"></span>44507</td>
<td class="instruction">LD A,(IX+2)</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44510"></span>44510</td>
<td class="instruction">AND A</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44511"></span>44511</td>
<td class="instruction">JP NZ,<a href="43397.html">43397</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="44514"></span>
<div class="comments">
<div class="paragraph">
Initialise the player movement (0000 == no movement).
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44514"></span>44514</td>
<td class="instruction">LD DE,0</td>
<td class="comment-1" rowspan="1"><span class="register">DE</span>=0000.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44517"></span>44517</td>
<td class="instruction">CALL <a href="45219.html">HandlerControls</a></td>
<td class="comment-1" rowspan="1">Call <a href="45219.html">HandlerControls</a>.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="44520"></span>
<div class="comments">
<div class="paragraph">
Check if the player is under the influence of an orchid.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44520"></span>44520</td>
<td class="instruction">LD A,(IX+5)</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=the colour of the player.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44523"></span>44523</td>
<td class="instruction">CP 71</td>
<td class="comment-1" rowspan="2">If the player is not using attribute 71 (white) then jump to <a href="44596.html">44596</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44525"></span>44525</td>
<td class="instruction">JR NZ,<a href="44596.html">44596</a></td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="44527"></span>
<div class="comments">
<div class="paragraph">
Controllers for player controls.
</div>
<div class="paragraph">
Handle "fire".
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44527"></span>44527</td>
<td class="instruction">BIT 4,C</td>
<td class="comment-1" rowspan="2">Jump to <a href="44596.html">44596</a> if "fire" was pressed.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44529"></span>44529</td>
<td class="instruction">JR Z,<a href="44596.html">44596</a></td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="44531"></span>
<div class="comments">
<div class="paragraph">
Handle "right".
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44531"></span>44531</td>
<td class="instruction">BIT 1,C</td>
<td class="comment-1" rowspan="2">Jump to <a href="44496.html#44539">PlayerMovement_Left</a> if "right" was pressed.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44533"></span>44533</td>
<td class="instruction">JR Z,<a href="44496.html#44539">PlayerMovement_Left</a></td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="44535"></span>
<div class="comments">
<div class="paragraph">
Update movement for moving right.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44535"></span>44535</td>
<td class="instruction">LD A,E</td>
<td class="comment-1" rowspan="3"><span class="register">E</span>=<span class="register">E</span>+32.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44536"></span>44536</td>
<td class="instruction">ADD A,32</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44538"></span>44538</td>
<td class="instruction">LD E,A</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="44539"></span>
<div class="comments">
<div class="paragraph">
Handle "left".
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">PlayerMovement_Left</td>
<td class="address-2"><span id="44539"></span>44539</td>
<td class="instruction">BIT 0,C</td>
<td class="comment-1" rowspan="2">Jump to <a href="44496.html#44547">PlayerMovement_Down</a> if "left" was pressed.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44541"></span>44541</td>
<td class="instruction">JR Z,<a href="44496.html#44547">PlayerMovement_Down</a></td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="44543"></span>
<div class="comments">
<div class="paragraph">
Update movement for moving left.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44543"></span>44543</td>
<td class="instruction">LD A,E</td>
<td class="comment-1" rowspan="3"><span class="register">E</span>=<span class="register">E</span>-32.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44544"></span>44544</td>
<td class="instruction">SUB 32</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44546"></span>44546</td>
<td class="instruction">LD E,A</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="44547"></span>
<div class="comments">
<div class="paragraph">
Handle "down".
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">PlayerMovement_Down</td>
<td class="address-2"><span id="44547"></span>44547</td>
<td class="instruction">BIT 2,C</td>
<td class="comment-1" rowspan="2">Jump to <a href="44496.html#44555">PlayerMovement_Up</a> if "down" was pressed.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44549"></span>44549</td>
<td class="instruction">JR Z,<a href="44496.html#44555">PlayerMovement_Up</a></td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="44551"></span>
<div class="comments">
<div class="paragraph">
Update movement for moving down.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44551"></span>44551</td>
<td class="instruction">LD A,D</td>
<td class="comment-1" rowspan="3"><span class="register">D</span>=<span class="register">D</span>-32.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44552"></span>44552</td>
<td class="instruction">SUB 32</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44554"></span>44554</td>
<td class="instruction">LD D,A</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="44555"></span>
<div class="comments">
<div class="paragraph">
Handle "up".
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">PlayerMovement_Up</td>
<td class="address-2"><span id="44555"></span>44555</td>
<td class="instruction">BIT 3,C</td>
<td class="comment-1" rowspan="2">Jump to <a href="44496.html#44563">PlayerMovement_0</a> if "up" was pressed.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44557"></span>44557</td>
<td class="instruction">JR Z,<a href="44496.html#44563">PlayerMovement_0</a></td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="44559"></span>
<div class="comments">
<div class="paragraph">
Update movement for moving up.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44559"></span>44559</td>
<td class="instruction">LD A,D</td>
<td class="comment-1" rowspan="3"><span class="register">D</span>=<span class="register">D</span>+32.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44560"></span>44560</td>
<td class="instruction">ADD A,32</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44562"></span>44562</td>
<td class="instruction">LD D,A</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="44563"></span>
<div class="comments">
<div class="paragraph">
Update the player Actor Entity.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">PlayerMovement_0</td>
<td class="address-2"><span id="44563"></span>44563</td>
<td class="instruction">LD (IX+6),E</td>
<td class="comment-1" rowspan="1">Write <span class="register">E</span> to <span class="register">IX</span>+6.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44566"></span>44566</td>
<td class="instruction">LD (IX+7),D</td>
<td class="comment-1" rowspan="1">Write <span class="register">D</span> to <span class="register">IX</span>+7.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44569"></span>44569</td>
<td class="instruction">CALL <a href="45032.html">45032</a></td>
<td class="comment-1" rowspan="1">Call <a href="45032.html">45032</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44572"></span>44572</td>
<td class="instruction">LD BC,5646</td>
<td class="comment-1" rowspan="1"><span class="register">BC</span>=5646.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44575"></span>44575</td>
<td class="instruction">CALL <a href="47132.html">47132</a></td>
<td class="comment-1" rowspan="1">Call <a href="47132.html">47132</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44578"></span>44578</td>
<td class="instruction">CALL <a href="44619.html">44619</a></td>
<td class="comment-1" rowspan="1">Call <a href="44619.html">44619</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44581"></span>44581</td>
<td class="instruction">CALL <a href="43757.html">43757</a></td>
<td class="comment-1" rowspan="1">Call <a href="43757.html">43757</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44584"></span>44584</td>
<td class="instruction">LD (IX+3),E</td>
<td class="comment-1" rowspan="1">Write <span class="register">E</span> to <span class="register">IX</span>+3 (sprite x co-ordinate).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44587"></span>44587</td>
<td class="instruction">LD (IX+4),D</td>
<td class="comment-1" rowspan="1">Write <span class="register">D</span> to <span class="register">IX</span>+4 (sprite y co-ordinate).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44590"></span>44590</td>
<td class="instruction">CALL NZ,<a href="48971.html">48971</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44593"></span>44593</td>
<td class="instruction">JP <a href="44375.html#44381">44381</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="44375.html#44381">44381</a>.</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="44479.html">44479</a>
</td>
<td class="up">Up: <a href="../maps/all.html#44496">Map</a></td>
<td class="next">
Next: <a href="44596.html">44596</a>
</td>
</tr>
</table>
<footer>
<div class="release"></div>
<div class="copyright">&copy; 1983 Ultimate Play the Game &copy; 2023 ArcadeGeek LTD.</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 8.10.</div>
<div><a href="../../asm/ADD0.html">Switch to hexadecimal</a>.</div>
</footer>
</body>
</html>