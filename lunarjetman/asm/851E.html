<!DOCTYPE html>
<html>
<head>
<title>Lunar Jetman: Routine at 851E</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-dark.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-wide.css" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-75RERFCHBG"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-75RERFCHBG');
</script>
</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="logo" src="../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="8506.html">8506</a>
</td>
<td class="up">Up: <a href="../maps/all.html#851e">Map</a></td>
<td class="next">
Next: <a href="853D.html">853D</a>
</td>
</tr>
</table>
<div class="description">851E: Calculate Screen Address</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
<div class="paragraph">
Used by the routines at <a href="81AB.html">MenuWriteText</a>, <a href="86A1.html">86A1</a>, <a href="8826.html">8826</a>, <a href="894F.html">DisplayPlayerLives</a>, <a href="8A11.html">PrintStringColour</a>, <a href="8A5C.html">8A5C</a>, <a href="8C01.html">8C01</a>, <a href="9E2C.html">LaserBeam_Animate</a>, <a href="A880.html">A880</a>, <a href="F410.html">HallOfFame</a> and <a href="F632.html">F632</a>.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">ScreenAddress</td>
<td class="address-2"><span id="851e"></span>851E</td>
<td class="instruction">LD A,L</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=<span class="register">L</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="851f"></span>851F</td>
<td class="instruction">RRCA</td>
<td class="comment-1" rowspan="3"><span class="register">A</span>=<span class="register">A</span> / 08.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="8520"></span>8520</td>
<td class="instruction">RRCA</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="8521"></span>8521</td>
<td class="instruction">RRCA</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="8522"></span>8522</td>
<td class="instruction">AND %00011111</td>
<td class="comment-1" rowspan="1">Keep only bits 0-4.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="8524"></span>8524</td>
<td class="instruction">LD L,A</td>
<td class="comment-1" rowspan="1"><span class="register">L</span>=<span class="register">A</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="8525"></span>8525</td>
<td class="instruction">LD A,H</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=<span class="register">H</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="8526"></span>8526</td>
<td class="instruction">RLCA</td>
<td class="comment-1" rowspan="2"><span class="register">A</span>=<span class="register">A</span> * 04.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="8527"></span>8527</td>
<td class="instruction">RLCA</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="8528"></span>8528</td>
<td class="instruction">AND %11100000</td>
<td class="comment-1" rowspan="1">Keep only bits 5-7.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="852a"></span>852A</td>
<td class="instruction">OR L</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="852b"></span>852B</td>
<td class="instruction">LD L,A</td>
<td class="comment-1" rowspan="1"><span class="register">L</span>=<span class="register">A</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="852c"></span>852C</td>
<td class="instruction">LD A,H</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=<span class="register">H</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="852d"></span>852D</td>
<td class="instruction">AND %00000111</td>
<td class="comment-1" rowspan="1">Keep only bits 0-2.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="852f"></span>852F</td>
<td class="instruction">EX AF,AF'</td>
<td class="comment-1" rowspan="1">Switch to the shadow <span class="register">AF</span> register.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="8530"></span>8530</td>
<td class="instruction">LD A,H</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=<span class="register">H</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="8531"></span>8531</td>
<td class="instruction">RRCA</td>
<td class="comment-1" rowspan="3"><span class="register">A</span>=<span class="register">A</span> / 08.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="8532"></span>8532</td>
<td class="instruction">RRCA</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="8533"></span>8533</td>
<td class="instruction">RRCA</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="8534"></span>8534</td>
<td class="instruction">AND %00011000</td>
<td class="comment-1" rowspan="1">Keep only bits 3-4.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="8536"></span>8536</td>
<td class="instruction">OR %01000000</td>
<td class="comment-1" rowspan="1">Set bit 6.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="8538"></span>8538</td>
<td class="instruction">LD H,A</td>
<td class="comment-1" rowspan="1"><span class="register">H</span>=<span class="register">A</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="8539"></span>8539</td>
<td class="instruction">EX AF,AF'</td>
<td class="comment-1" rowspan="1">Switch to the shadow <span class="register">AF</span> register.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="853a"></span>853A</td>
<td class="instruction">OR H</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="853b"></span>853B</td>
<td class="instruction">LD H,A</td>
<td class="comment-1" rowspan="1"><span class="register">H</span>=<span class="register">A</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="853c"></span>853C</td>
<td class="instruction">RET</td>
<td class="comment-1" rowspan="1">Return.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<div class="comments">
<div class="paragraph">
View the equivalent code in; <ul class="">
<li><a href="/ultimate/aticatac/asm/9BA2.html">Atic Atac</a></li>
<li><a href="/ultimate/cookie/asm/76E3.html">Cookie</a></li>
<li><a href="/ultimate/jetpac/asm/7308.html">Jetpac</a></li>
<li><a href="/ultimate/pssst/asm/759A.html">Pssst</a></li>
<li><a href="/ultimate/tranzam/asm/6F10.html">Tranz Am</a></li>
</ul>
</div>
</div>
</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="8506.html">8506</a>
</td>
<td class="up">Up: <a href="../maps/all.html#851e">Map</a></td>
<td class="next">
Next: <a href="853D.html">853D</a>
</td>
</tr>
</table>
<footer>
<div class="release"></div>
<div class="copyright">&copy; 1983 Ultimate Play the Game &copy; 2023 ArcadeGeek LTD.</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 8.10.</div>
<div><a href="../dec/asm/34078.html">Switch to decimal</a>.</div>
</footer>
</body>
</html>