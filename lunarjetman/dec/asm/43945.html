<!DOCTYPE html>
<html>
<head>
<title>Lunar Jetman: Routine at 43945</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-dark.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-wide.css" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-75RERFCHBG"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-75RERFCHBG');
</script>
</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="logo" src="../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="43933.html">43933</a>
</td>
<td class="up">Up: <a href="../maps/all.html#43945">Map</a></td>
<td class="next">
Next: <a href="44089.html">44089</a>
</td>
</tr>
</table>
<div class="description">43945: Routine at ABA9</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
<div class="paragraph">
Used by the routine at <a href="44089.html">44089</a>.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-2"><span id="43945"></span>43945</td>
<td class="instruction">LD A,(IX+0)</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=<span class="register">IX</span>+0.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43948"></span>43948</td>
<td class="instruction">INC A</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43949"></span>43949</td>
<td class="instruction">AND %00001111</td>
<td class="comment-1" rowspan="1">Keep only bits 0-3.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43951"></span>43951</td>
<td class="instruction">ADD A,112</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43953"></span>43953</td>
<td class="instruction">LD (IX+0),A</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="43956"></span>
<div class="comments">
<div class="paragraph">
This entry point is used by the routines at <a href="41386.html">41386</a>, <a href="41765.html">41765</a>, <a href="41983.html">41983</a>, <a href="42854.html">42854</a>, <a href="44089.html">44089</a>, <a href="44342.html">44342</a>, <a href="45476.html">45476</a>, <a href="45885.html">45885</a>, <a href="45947.html">45947</a>, <a href="46176.html">46176</a>, <a href="46981.html">46981</a> and <a href="47120.html">47120</a>.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-2"><span id="43956"></span>43956</td>
<td class="instruction">CALL <a href="34561.html">34561</a></td>
<td class="comment-1" rowspan="1">Call <a href="34561.html">34561</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43959"></span>43959</td>
<td class="instruction">JP <a href="34611.html">34611</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="34611.html">34611</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43962"></span>43962</td>
<td class="instruction">LD E,24</td>
<td class="comment-1" rowspan="1"><span class="register">E</span>=24.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43964"></span>43964</td>
<td class="instruction">CALL <a href="45592.html#45732">45732</a></td>
<td class="comment-1" rowspan="1">Call <a href="45592.html#45732">45732</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43967"></span>43967</td>
<td class="instruction">CALL C,<a href="45592.html#45783">45783</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43970"></span>43970</td>
<td class="instruction">LD A,(IX+23)</td>
<td class="comment-1" rowspan="3">If <span class="register">IX</span>+23 is zero, jump to <a href="44089.html#44094">44094</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43973"></span>43973</td>
<td class="instruction">AND A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43974"></span>43974</td>
<td class="instruction">JR Z,<a href="44089.html#44094">44094</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43976"></span>43976</td>
<td class="instruction">CALL <a href="43945.html#43945">43945</a></td>
<td class="comment-1" rowspan="1">Call <a href="43945.html">43945</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43979"></span>43979</td>
<td class="instruction">LD A,(24130)</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=<a href="24130.html">24130</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43982"></span>43982</td>
<td class="instruction">CPL</td>
<td class="comment-1" rowspan="1">Flip the bits.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43983"></span>43983</td>
<td class="instruction">AND %00001111</td>
<td class="comment-1" rowspan="1">Keep only bits 0-3.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43985"></span>43985</td>
<td class="instruction">RET NZ</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43986"></span>43986</td>
<td class="instruction">LD A,(24167)</td>
<td class="comment-1" rowspan="3">If <a href="24167.html">GameDelayTimer</a> is not zero, jump to <a href="43945.html#44005">44005</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43989"></span>43989</td>
<td class="instruction">AND A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43990"></span>43990</td>
<td class="instruction">JR NZ,<a href="43945.html#44005">44005</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43992"></span>43992</td>
<td class="instruction">LD A,(24696)</td>
<td class="comment-1" rowspan="3">If <a href="24672.html#24696">24696</a> is 129 jump toÂ <a href="43945.html#44005">44005</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43995"></span>43995</td>
<td class="instruction">CP 129</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43997"></span>43997</td>
<td class="instruction">JR Z,<a href="43945.html#44005">44005</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="43999"></span>43999</td>
<td class="instruction">DEC (IX+23)</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44002"></span>44002</td>
<td class="instruction">CALL Z,<a href="44342.html#45423">45423</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-2"><span id="44005"></span>44005</td>
<td class="instruction">LD A,(IX+23)</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44008"></span>44008</td>
<td class="instruction">LD HL,8256</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=8256.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44011"></span>44011</td>
<td class="instruction">CALL <a href="35841.html">DrawGauge</a></td>
<td class="comment-1" rowspan="1">Call <a href="35841.html">DrawGauge</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44014"></span>44014</td>
<td class="instruction">CALL <a href="44342.html">44342</a></td>
<td class="comment-1" rowspan="1">Call <a href="44342.html">44342</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44017"></span>44017</td>
<td class="instruction">JR NC,<a href="43945.html#44073">44073</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44019"></span>44019</td>
<td class="instruction">CALL <a href="44299.html">44299</a></td>
<td class="comment-1" rowspan="1">Call <a href="44299.html">44299</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44022"></span>44022</td>
<td class="instruction">LD HL,22651</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=22651 (attribute buffer location).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44025"></span>44025</td>
<td class="instruction">CALL <a href="44288.html">Handler_Colour2x2</a></td>
<td class="comment-1" rowspan="1">Call <a href="44288.html">Handler_Colour2x2</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44028"></span>44028</td>
<td class="instruction">LD HL,22653</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=22653 (attribute buffer location).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44031"></span>44031</td>
<td class="instruction">LD A,66</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=66 (attribute value).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-2"><span id="44033"></span>44033</td>
<td class="instruction">CALL <a href="44288.html">Handler_Colour2x2</a></td>
<td class="comment-1" rowspan="1">Call <a href="44288.html">Handler_Colour2x2</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44036"></span>44036</td>
<td class="instruction">LD A,(24130)</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=<a href="24130.html">24130</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44039"></span>44039</td>
<td class="instruction">AND %00111111</td>
<td class="comment-1" rowspan="1">Keep only bits 0-5.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44041"></span>44041</td>
<td class="instruction">CP 15</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44043"></span>44043</td>
<td class="instruction">JR Z,<a href="43945.html#44058">44058</a></td>
<td class="comment-1" rowspan="1">If so, jump to <a href="43945.html#44058">44058</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44045"></span>44045</td>
<td class="instruction">CP 47</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44047"></span>44047</td>
<td class="instruction">RET NZ</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="44048"></span>
<div class="comments">
<div class="paragraph">
Handle printing the "<img alt="alien" src="../../images/font/alien.png" />" messaging.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44048"></span>44048</td>
<td class="instruction">LD DE,44068</td>
<td class="comment-1" rowspan="1"><span class="register">DE</span>=<a href="43945.html#44068">BannerMessaging_Alien</a>.</td>
</tr>
<tr>
<td class="asm-label">BannerMessaging_Print</td>
<td class="address-2"><span id="44051"></span>44051</td>
<td class="instruction">LD HL,4312</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=4312 (screen location).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44054"></span>44054</td>
<td class="instruction">CALL <a href="35345.html">PrintStringColour</a></td>
<td class="comment-1" rowspan="1">Call <a href="35345.html">PrintStringColour</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44057"></span>44057</td>
<td class="instruction">RET</td>
<td class="comment-1" rowspan="1">Return.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="44058"></span>
<div class="comments">
<div class="paragraph">
Handle printing the "<img alt="base" src="../../images/font/base.png" />" messaging.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-2"><span id="44058"></span>44058</td>
<td class="instruction">LD DE,44063</td>
<td class="comment-1" rowspan="1"><span class="register">DE</span>=<a href="43945.html#44063">BannerMessaging_Base</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44061"></span>44061</td>
<td class="instruction">JR <a href="43945.html#44051">BannerMessaging_Print</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="43945.html#44051">BannerMessaging_Print</a>.</td>
</tr>
<tr>
<td class="asm-label">BannerMessaging_Base</td>
<td class="address-1"><span id="44063"></span>44063</td>
<td class="instruction">DEFM "Ecde","f"+128</td>
<td class="comment-1" rowspan="1">Attribute: 69 + "<img alt="base" src="../../images/font/base.png" />".</td>
</tr>
<tr>
<td class="asm-label">BannerMessaging_Alien</td>
<td class="address-1"><span id="44068"></span>44068</td>
<td class="instruction">DEFM "Eghi","j"+128</td>
<td class="comment-1" rowspan="1">Attribute: 69 + "<img alt="alien" src="../../images/font/alien.png" />".</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-2"><span id="44073"></span>44073</td>
<td class="instruction">CALL <a href="44299.html">44299</a></td>
<td class="comment-1" rowspan="1">Call <a href="44299.html">44299</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44076"></span>44076</td>
<td class="instruction">LD HL,22653</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=22653 (attribute buffer location).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44079"></span>44079</td>
<td class="instruction">CALL <a href="44288.html">Handler_Colour2x2</a></td>
<td class="comment-1" rowspan="1">Call <a href="44288.html">Handler_Colour2x2</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44082"></span>44082</td>
<td class="instruction">LD HL,22651</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=22651 (attribute buffer location).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44085"></span>44085</td>
<td class="instruction">LD A,66</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=66 (attribute byte).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="44087"></span>44087</td>
<td class="instruction">JR <a href="43945.html#44033">44033</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="43945.html#44033">44033</a>.</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="43933.html">43933</a>
</td>
<td class="up">Up: <a href="../maps/all.html#43945">Map</a></td>
<td class="next">
Next: <a href="44089.html">44089</a>
</td>
</tr>
</table>
<footer>
<div class="release"></div>
<div class="copyright">&copy; 1983 Ultimate Play the Game &copy; 2023 ArcadeGeek LTD.</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 8.10.</div>
<div><a href="../../asm/ABA9.html">Switch to hexadecimal</a>.</div>
</footer>
</body>
</html>